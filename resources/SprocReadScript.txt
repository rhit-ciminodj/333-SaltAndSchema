CREATE OR ALTER PROCEDURE getRecipeStars(
	@recipeID int,
	@stars float
)
AS
BEGIN
	SET @stars = 0

	IF(@recipeID IS NULL)
	BEGIN;
		THROW 51000, 'Null input', 1
		RETURN
	END

	IF NOT EXISTS(SELECT 1 FROM Recipe r WHERE r.RecipeID = @recipeID)
	BEGIN;
		THROW 51001, 'Recipe does not exist', 1
		RETURN
	END
	
	SET @stars = (
		SELECT AVG(CAST(h.Stars AS FLOAT))
		FROM HasEaten h
		WHERE h.RecipeID = @recipeID
	)
END
	
